{"paragraphs":[{"text":"%md\n# Spark Structured Streaming Truck Demo","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Spark Structured Streaming Truck Demo</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1589969898934_1014322840","id":"20180321-225251_218089137","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5976"},{"text":"%md\nRun the simulator using the following docker command: \n\ndocker run trivadis/iot-truck-simulator '-s' 'KAFKA' '-h' $PUBLIC_IP '-p' '9092' '-f' 'JSON' \"-t\" \"sec\"\n","user":"admin","dateUpdated":"2020-05-20T12:25:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589970254437_-1554966264","id":"20200520-122414_415778383","dateCreated":"2020-05-20T12:24:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8846","dateFinished":"2020-05-20T12:25:07+0200","dateStarted":"2020-05-20T12:25:07+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Run the simulator using the following docker command: </p>\n<p>docker run trivadis/iot-truck-simulator &lsquo;-s&rsquo; &lsquo;KAFKA&rsquo; &lsquo;-h&rsquo; $PUBLIC_IP &lsquo;-p&rsquo; &lsquo;9092&rsquo; &lsquo;-f&rsquo; &lsquo;JSON&rsquo; &ldquo;-t&rdquo; &ldquo;sec&rdquo;</p>\n</div>"}]}},{"text":"spark.version","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res1: String = 2.4.5\n"}]},"apps":[],"jobName":"paragraph_1589969898942_-546665785","id":"20180317-204739_494176690","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5977"},{"title":"Define Schema for truck_position events/messages","text":"import org.apache.spark.sql.types.StructType\nimport org.apache.spark.sql.types.StringType\nimport org.apache.spark.sql.types.DoubleType\nimport org.apache.spark.sql.types.LongType\nimport org.apache.spark.sql.types.TimestampType\n\nval truckPositionSchema = new StructType() \n  .add(\"timestamp\",  TimestampType) \n  .add(\"truckId\", LongType) \n  .add(\"driverId\", LongType) \n  .add(\"routeId\", LongType) \n  .add(\"eventType\", StringType) \n  .add(\"latitude\", DoubleType) \n  .add(\"longitude\", DoubleType) \n  .add(\"correlationId\", StringType) ","user":"admin","dateUpdated":"2020-05-20T12:26:30+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types.StructType\nimport org.apache.spark.sql.types.StringType\nimport org.apache.spark.sql.types.DoubleType\nimport org.apache.spark.sql.types.LongType\nimport org.apache.spark.sql.types.TimestampType\ntruckPositionSchema: org.apache.spark.sql.types.StructType = StructType(StructField(timestamp,TimestampType,true), StructField(truckId,LongType,true), StructField(driverId,LongType,true), StructField(routeId,LongType,true), StructField(eventType,StringType,true), StructField(latitude,DoubleType,true), StructField(longitude,DoubleType,true), StructField(correlationId,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1589969898943_1734242888","id":"20180318-135726_1324017309","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5978","dateFinished":"2020-05-20T12:26:31+0200","dateStarted":"2020-05-20T12:26:30+0200"},{"title":"Kafka Consumer","text":"val rawDf = spark\n  .readStream\n  .format(\"kafka\")\n  .option(\"kafka.bootstrap.servers\", \"kafka-1:19092,kafka-2:19093\")\n  .option(\"subscribe\", \"truck_position\")\n  .load()","user":"admin","dateUpdated":"2020-05-20T12:26:33+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rawDf: org.apache.spark.sql.DataFrame = [key: binary, value: binary ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1589969898944_323033205","id":"20180318-172956_1421875863","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5979","dateFinished":"2020-05-20T12:26:33+0200","dateStarted":"2020-05-20T12:26:33+0200"},{"title":"Show the schema of the raw Kafka message","text":"rawDf.printSchema","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- key: binary (nullable = true)\n |-- value: binary (nullable = true)\n |-- topic: string (nullable = true)\n |-- partition: integer (nullable = true)\n |-- offset: long (nullable = true)\n |-- timestamp: timestamp (nullable = true)\n |-- timestampType: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1589969898944_1933120859","id":"20180318-173326_303176158","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5980"},{"title":"Map to \"truck_position\" schema and extract event time (trunc to seconds)","text":"val jsonDf = rawDf.select($\"value\" cast \"string\" as \"json\")\n            .select(from_json($\"json\", truckPositionSchema) as \"data\")\n            .selectExpr(\"data.*\", \"cast(cast (data.timestamp as double) / 1000 as timestamp) as eventTime\")\n","user":"admin","dateUpdated":"2020-05-20T12:26:37+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"jsonDf: org.apache.spark.sql.DataFrame = [timestamp: timestamp, truckId: bigint ... 7 more fields]\n"}]},"apps":[],"jobName":"paragraph_1589969898945_-1535090158","id":"20180318-173147_1059784308","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5981","dateFinished":"2020-05-20T12:26:39+0200","dateStarted":"2020-05-20T12:26:37+0200"},{"text":"jsonDf.printSchema","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- timestamp: timestamp (nullable = true)\n |-- truckId: long (nullable = true)\n |-- driverId: long (nullable = true)\n |-- routeId: long (nullable = true)\n |-- eventType: string (nullable = true)\n |-- latitude: double (nullable = true)\n |-- longitude: double (nullable = true)\n |-- correlationId: string (nullable = true)\n |-- eventTime: timestamp (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1589969898946_-2086103429","id":"20200520-113812_530435404","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5982"},{"title":"Run 1st query into in memory \"table\"","text":"import org.apache.spark.sql.streaming.{OutputMode, Trigger}\nimport scala.concurrent.duration._\nval query1 = jsonDf.writeStream\n                            .format(\"memory\")\n                            .queryName(\"filtered_truck_position\")\n                            .start()","user":"admin","dateUpdated":"2020-05-20T12:49:03+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.streaming.{OutputMode, Trigger}\nimport scala.concurrent.duration._\nquery1: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@676f33e2\n"}]},"apps":[],"jobName":"paragraph_1589969898946_1633388025","id":"20180321-191241_706348644","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5983","dateFinished":"2020-05-20T12:49:13+0200","dateStarted":"2020-05-20T12:49:03+0200"},{"text":"spark.sql (\"select * from filtered_truck_position\").show()  ","user":"admin","dateUpdated":"2020-05-20T12:27:02+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------+--------+----------+--------------+--------+---------+--------------------+--------------------+\n|           timestamp|truckId|driverId|   routeId|     eventType|latitude|longitude|       correlationId|           eventTime|\n+--------------------+-------+--------+----------+--------------+--------+---------+--------------------+--------------------+\n|52354-02-27 10:20...|     93|      27|1594289134|        Normal|   38.99|   -93.45|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:18...|     58|      13| 160779139|        Normal|   42.04|   -88.02|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:13...|     96|      29|1565885487|        Normal|   35.51|   -95.15|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:36...|     69|      20|1384345811|        Normal|   42.04|   -88.02|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:42...|     63|      14| 927636994|        Normal|   37.16|   -94.46|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:53...|     76|      15|1090292248|        Normal|   35.19|   -90.04|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:55...|     51|      24| 371182829|        Normal|   40.38|   -89.17|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 11:10...|     93|      27|1594289134|        Normal|    39.0|   -93.65|-1744411251736480691|2020-05-20 12:27:...|\n|52354-02-27 10:33...|     61|      11|1567254452|Lane Departure|   40.38|   -89.17|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:35...|     37|      26|1390372503|        Normal|   37.26|   -93.14|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:46...|     34|      31| 160779139|        Normal|   37.16|   -94.46|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:54...|     20|      17| 160405074|        Normal|   38.99|   -93.45|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 11:11...|     58|      13| 160779139|        Normal|   41.89|   -87.66|-1744411251736480691|2020-05-20 12:27:...|\n|52354-02-27 10:55...|    105|      25| 987179512|        Normal|   37.47|   -89.71|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:59...|     39|      30| 160405074|        Normal|   42.04|   -88.02|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 11:12...|     96|      29|1565885487|        Normal|   35.47|   -94.88|-1744411251736480691|2020-05-20 12:27:...|\n|52354-02-27 10:51...|     84|      23|1927624662|        Normal|    40.7|   -89.52|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:35...|     52|      12|1325712174|        Normal|   37.47|   -89.71|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 10:36...|     83|      10|1962261785|        Normal|   37.26|   -93.14|-1744411251736480691|2020-05-20 12:26:...|\n|52354-02-27 11:27...|     83|      10|1962261785|        Normal|   37.21|   -93.34|-1744411251736480691|2020-05-20 12:27:...|\n+--------------------+-------+--------+----------+--------------+--------+---------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589969898947_1887492291","id":"20180321-191244_1566482143","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5984","dateFinished":"2020-05-20T12:27:03+0200","dateStarted":"2020-05-20T12:27:02+0200"},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"timestamp":"string","truckId":"string","driverId":"string","routeId":"string","eventType":"string","latitude":"string","longitude":"string","correlationId":"string","eventTime":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589971750738_-1009905738","id":"20200520-124910_1845741555","dateCreated":"2020-05-20T12:49:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19295","text":"%sql\nSELECT * FROM  filtered_truck_position order by timestamp desc","dateUpdated":"2020-05-20T12:49:51+0200","dateFinished":"2020-05-20T12:49:51+0200","dateStarted":"2020-05-20T12:49:51+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"timestamp\ttruckId\tdriverId\trouteId\teventType\tlatitude\tlongitude\tcorrelationId\teventTime\n52354-03-15 07:45:28.0\t58\t13\t160779139\tNormal\t38.99\t-94.38\t-1744411251736480691\t2020-05-20 12:49:50.728\n52354-03-15 07:43:58.0\t105\t25\t987179512\tNormal\t38.82\t-90.93\t-1744411251736480691\t2020-05-20 12:49:50.638\n52354-03-15 07:41:28.0\t34\t31\t160779139\tNormal\t39.37\t-94.36\t-1744411251736480691\t2020-05-20 12:49:50.488\n52354-03-15 07:41:08.0\t44\t19\t137128276\tNormal\t39.67\t-91.8\t-1744411251736480691\t2020-05-20 12:49:50.468\n52354-03-15 07:40:08.0\t83\t10\t1962261785\tNormal\t41.71\t-93.04\t-1744411251736480691\t2020-05-20 12:49:50.408\n52354-03-15 07:39:59.0\t51\t24\t371182829\tNormal\t38.65\t-90.2\t-1744411251736480691\t2020-05-20 12:49:50.399\n52354-03-15 07:38:18.0\t76\t15\t1090292248\tNormal\t41.71\t-91.32\t-1744411251736480691\t2020-05-20 12:49:50.297999\n52354-03-15 07:37:33.0\t20\t17\t160405074\tNormal\t38.81\t-90.55\t-1744411251736480691\t2020-05-20 12:49:50.253\n52354-03-15 07:36:28.0\t39\t30\t160405074\tNormal\t41.92\t-89.03\t-1744411251736480691\t2020-05-20 12:49:50.188\n52354-03-15 07:36:18.0\t49\t32\t1198242881\tNormal\t39.03\t-94.0\t-1744411251736480691\t2020-05-20 12:49:50.177999\n52354-03-15 07:32:18.0\t37\t26\t1390372503\tNormal\t37.7\t-92.61\t-1744411251736480691\t2020-05-20 12:49:49.937999\n52354-03-15 07:31:38.0\t85\t22\t1198242881\tNormal\t35.64\t-95.3\t-1744411251736480691\t2020-05-20 12:49:49.897999\n52354-03-15 07:30:18.0\t102\t21\t1090292248\tNormal\t34.78\t-92.31\t-1744411251736480691\t2020-05-20 12:49:49.817999\n52354-03-15 07:26:58.0\t96\t29\t1565885487\tNormal\t42.25\t-88.96\t-1744411251736480691\t2020-05-20 12:49:49.617999\n52354-03-15 07:14:38.0\t84\t23\t1927624662\tNormal\t35.19\t-90.04\t-1744411251736480691\t2020-05-20 12:49:48.878\n52354-03-15 07:13:08.0\t93\t27\t1594289134\tNormal\t42.21\t-88.64\t-1744411251736480691\t2020-05-20 12:49:48.788\n52354-03-15 07:09:58.0\t69\t20\t1384345811\tNormal\t35.19\t-90.04\t-1744411251736480691\t2020-05-20 12:49:48.598\n52354-03-15 07:08:18.0\t100\t18\t1594289134\tNormal\t39.69\t-90.79\t-1744411251736480691\t2020-05-20 12:49:48.497999\n52354-03-15 07:07:28.0\t52\t12\t1325712174\tNormal\t41.74\t-92.19\t-1744411251736480691\t2020-05-20 12:49:48.448\n52354-03-15 07:05:59.0\t61\t11\t1567254452\tUnsafe following distance\t40.86\t-89.91\t-1744411251736480691\t2020-05-20 12:49:48.359\n52354-03-15 07:00:48.0\t31\t28\t803014426\tNormal\t34.78\t-92.31\t-1744411251736480691\t2020-05-20 12:49:48.048\n52354-03-15 06:57:58.0\t16\t16\t1325562373\tNormal\t39.1\t-94.44\t-1744411251736480691\t2020-05-20 12:49:47.878\n52354-03-15 06:47:58.0\t34\t31\t160779139\tNormal\t39.53\t-94.28\t-1744411251736480691\t2020-05-20 12:49:47.278\n52354-03-15 06:47:30.0\t76\t15\t1090292248\tNormal\t41.74\t-91.47\t-1744411251736480691\t2020-05-20 12:49:47.249999\n52354-03-15 06:45:38.0\t44\t19\t137128276\tNormal\t39.71\t-92.07\t-1744411251736480691\t2020-05-20 12:49:47.137999\n52354-03-15 06:44:17.0\t58\t13\t160779139\tNormal\t38.67\t-94.38\t-1744411251736480691\t2020-05-20 12:49:47.057\n52354-03-15 06:42:48.0\t63\t14\t927636994\tNormal\t41.87\t-87.67\t-1744411251736480691\t2020-05-20 12:49:46.968\n52354-03-15 06:39:28.0\t105\t25\t987179512\tNormal\t38.83\t-91.1\t-1744411251736480691\t2020-05-20 12:49:46.768\n52354-03-15 06:39:08.0\t37\t26\t1390372503\tNormal\t37.8\t-92.48\t-1744411251736480691\t2020-05-20 12:49:46.748\n52354-03-15 06:37:58.0\t20\t17\t160405074\tNormal\t38.82\t-90.67\t-1744411251736480691\t2020-05-20 12:49:46.678\n52354-03-15 06:37:28.0\t39\t30\t160405074\tNormal\t42.25\t-88.96\t-1744411251736480691\t2020-05-20 12:49:46.648\n52354-03-15 06:37:18.0\t83\t10\t1962261785\tNormal\t41.75\t-92.74\t-1744411251736480691\t2020-05-20 12:49:46.638\n52354-03-15 06:34:48.0\t49\t32\t1198242881\tNormal\t39.01\t-93.85\t-1744411251736480691\t2020-05-20 12:49:46.488\n52354-03-15 06:33:29.0\t51\t24\t371182829\tNormal\t39.1\t-89.74\t-1744411251736480691\t2020-05-20 12:49:46.409\n52354-03-15 06:32:28.0\t85\t22\t1198242881\tNormal\t35.87\t-95.42\t-1744411251736480691\t2020-05-20 12:49:46.348\n52354-03-15 06:27:39.0\t96\t29\t1565885487\tNormal\t42.21\t-88.64\t-1744411251736480691\t2020-05-20 12:49:46.059\n52354-03-15 06:25:49.0\t102\t21\t1090292248\tNormal\t34.8\t-92.09\t-1744411251736480691\t2020-05-20 12:49:45.949\n52354-03-15 06:19:59.0\t84\t23\t1927624662\tNormal\t35.21\t-90.37\t-1744411251736480691\t2020-05-20 12:49:45.599\n52354-03-15 06:16:28.0\t93\t27\t1594289134\tNormal\t42.11\t-88.41\t-1744411251736480691\t2020-05-20 12:49:45.388\n52354-03-15 06:14:58.0\t69\t20\t1384345811\tNormal\t35.21\t-90.37\t-1744411251736480691\t2020-05-20 12:49:45.297999\n52354-03-15 06:07:48.0\t61\t11\t1567254452\tNormal\t40.96\t-90.29\t-1744411251736480691\t2020-05-20 12:49:44.868\n52354-03-15 06:07:29.0\t52\t12\t1325712174\tNormal\t41.78\t-92.4\t-1744411251736480691\t2020-05-20 12:49:44.849\n52354-03-15 06:05:39.0\t100\t18\t1594289134\tNormal\t39.7\t-90.63\t-1744411251736480691\t2020-05-20 12:49:44.739\n52354-03-15 05:59:29.0\t16\t16\t1325562373\tNormal\t39.04\t-94.31\t-1744411251736480691\t2020-05-20 12:49:44.369\n52354-03-15 05:57:38.0\t31\t28\t803014426\tNormal\t34.78\t-92.31\t-1744411251736480691\t2020-05-20 12:49:44.257999\n52354-03-15 05:53:28.0\t44\t19\t137128276\tNormal\t39.76\t-92.27\t-1744411251736480691\t2020-05-20 12:49:44.008\n52354-03-15 05:50:58.0\t58\t13\t160779139\tNormal\t38.33\t-94.35\t-1744411251736480691\t2020-05-20 12:49:43.857999\n52354-03-15 05:49:28.0\t34\t31\t160779139\tNormal\t39.63\t-94.24\t-1744411251736480691\t2020-05-20 12:49:43.768\n52354-03-15 05:44:58.0\t76\t15\t1090292248\tNormal\t41.72\t-91.63\t-1744411251736480691\t2020-05-20 12:49:43.497999\n52354-03-15 05:42:48.0\t83\t10\t1962261785\tNormal\t41.78\t-92.4\t-1744411251736480691\t2020-05-20 12:49:43.368\n52354-03-15 05:42:28.0\t49\t32\t1198242881\tNormal\t39.0\t-93.65\t-1744411251736480691\t2020-05-20 12:49:43.348\n52354-03-15 05:40:58.0\t63\t14\t927636994\tNormal\t41.48\t-88.07\t-1744411251736480691\t2020-05-20 12:49:43.257999\n52354-03-15 05:39:48.0\t51\t24\t371182829\tNormal\t39.84\t-89.63\t-1744411251736480691\t2020-05-20 12:49:43.188\n52354-03-15 05:38:48.0\t37\t26\t1390372503\tNormal\t37.81\t-92.31\t-1744411251736480691\t2020-05-20 12:49:43.128\n52354-03-15 05:37:08.0\t20\t17\t160405074\tNormal\t38.83\t-90.79\t-1744411251736480691\t2020-05-20 12:49:43.028\n52354-03-15 05:36:48.0\t105\t25\t987179512\tNormal\t38.83\t-91.19\t-1744411251736480691\t2020-05-20 12:49:43.008\n52354-03-15 05:34:28.0\t39\t30\t160405074\tNormal\t42.21\t-88.64\t-1744411251736480691\t2020-05-20 12:49:42.868\n52354-03-15 05:32:58.0\t85\t22\t1198242881\tNormal\t35.97\t-95.56\t-1744411251736480691\t2020-05-20 12:49:42.777999\n52354-03-15 05:31:29.0\t96\t29\t1565885487\tNormal\t42.11\t-88.41\t-1744411251736480691\t2020-05-20 12:49:42.689\n52354-03-15 05:22:38.0\t102\t21\t1090292248\tNormal\t34.81\t-91.93\t-1744411251736480691\t2020-05-20 12:49:42.158\n52354-03-15 05:20:28.0\t93\t27\t1594289134\tNormal\t42.04\t-88.02\t-1744411251736480691\t2020-05-20 12:49:42.028\n52354-03-15 05:18:08.0\t69\t20\t1384345811\tNormal\t35.12\t-90.68\t-1744411251736480691\t2020-05-20 12:49:41.888\n52354-03-15 05:16:09.0\t84\t23\t1927624662\tNormal\t35.12\t-90.68\t-1744411251736480691\t2020-05-20 12:49:41.769\n52354-03-15 05:15:28.0\t100\t18\t1594289134\tNormal\t39.71\t-90.52\t-1744411251736480691\t2020-05-20 12:49:41.728\n52354-03-15 05:12:08.0\t52\t12\t1325712174\tNormal\t41.75\t-92.74\t-1744411251736480691\t2020-05-20 12:49:41.528\n52354-03-15 05:08:18.0\t61\t11\t1567254452\tNormal\t41.54\t-90.44\t-1744411251736480691\t2020-05-20 12:49:41.297999\n52354-03-15 05:02:58.0\t16\t16\t1325562373\tNormal\t39.04\t-94.16\t-1744411251736480691\t2020-05-20 12:49:40.977999\n52354-03-15 05:02:08.0\t31\t28\t803014426\tNormal\t34.8\t-92.09\t-1744411251736480691\t2020-05-20 12:49:40.928\n52354-03-15 05:00:19.0\t44\t19\t137128276\tNormal\t39.76\t-92.42\t-1744411251736480691\t2020-05-20 12:49:40.819\n52354-03-15 04:55:38.0\t34\t31\t160779139\tNormal\t39.73\t-94.25\t-1744411251736480691\t2020-05-20 12:49:40.537999\n52354-03-15 04:52:18.0\t83\t10\t1962261785\tNormal\t41.74\t-92.19\t-1744411251736480691\t2020-05-20 12:49:40.337999\n52354-03-15 04:48:08.0\t58\t13\t160779139\tNormal\t38.0\t-94.37\t-1744411251736480691\t2020-05-20 12:49:40.088\n52354-03-15 04:47:38.0\t37\t26\t1390372503\tNormal\t37.81\t-92.08\t-1744411251736480691\t2020-05-20 12:49:40.057999\n52354-03-15 04:47:29.0\t76\t15\t1090292248\tNormal\t42.23\t-91.78\t-1744411251736480691\t2020-05-20 12:49:40.049\n52354-03-15 04:45:29.0\t51\t24\t371182829\tNormal\t40.38\t-89.17\t-1744411251736480691\t2020-05-20 12:49:39.929\n52354-03-15 04:41:48.0\t49\t32\t1198242881\tNormal\t38.99\t-93.45\t-1744411251736480691\t2020-05-20 12:49:39.708\n52354-03-15 04:40:27.0\t63\t14\t927636994\tNormal\t41.11\t-88.42\t-1744411251736480691\t2020-05-20 12:49:39.627\n52354-03-15 04:39:39.0\t105\t25\t987179512\tNormal\t38.87\t-91.33\t-1744411251736480691\t2020-05-20 12:49:39.579\n52354-03-15 04:33:38.0\t85\t22\t1198242881\tNormal\t36.08\t-95.76\t-1744411251736480691\t2020-05-20 12:49:39.217999\n52354-03-15 04:32:27.0\t20\t17\t160405074\tNormal\t38.82\t-90.93\t-1744411251736480691\t2020-05-20 12:49:39.147\n52354-03-15 04:31:38.0\t102\t21\t1090292248\tNormal\t34.89\t-91.74\t-1744411251736480691\t2020-05-20 12:49:39.097999\n52354-03-15 04:31:19.0\t96\t29\t1565885487\tNormal\t42.04\t-88.02\t-1744411251736480691\t2020-05-20 12:49:39.079\n52354-03-15 04:30:59.0\t39\t30\t160405074\tNormal\t42.11\t-88.41\t-1744411251736480691\t2020-05-20 12:49:39.059\n52354-03-15 04:23:48.0\t84\t23\t1927624662\tNormal\t35.03\t-90.94\t-1744411251736480691\t2020-05-20 12:49:38.628\n52354-03-15 04:21:29.0\t93\t27\t1594289134\tNormal\t41.89\t-87.66\t-1744411251736480691\t2020-05-20 12:49:38.489\n52354-03-15 04:19:48.0\t69\t20\t1384345811\tNormal\t35.03\t-90.94\t-1744411251736480691\t2020-05-20 12:49:38.388\n52354-03-15 04:17:58.0\t52\t12\t1325712174\tNormal\t41.71\t-93.04\t-1744411251736480691\t2020-05-20 12:49:38.278\n52354-03-15 04:12:48.0\t100\t18\t1594289134\tNormal\t39.71\t-90.37\t-1744411251736480691\t2020-05-20 12:49:37.968\n52354-03-15 04:10:48.0\t31\t28\t803014426\tNormal\t34.81\t-91.93\t-1744411251736480691\t2020-05-20 12:49:37.848\n52354-03-15 04:10:18.0\t16\t16\t1325562373\tNormal\t39.03\t-94.0\t-1744411251736480691\t2020-05-20 12:49:37.817999\n52354-03-15 04:04:08.0\t61\t11\t1567254452\tNormal\t41.62\t-90.7\t-1744411251736480691\t2020-05-20 12:49:37.448\n52354-03-15 03:59:49.0\t44\t19\t137128276\tNormal\t39.77\t-92.57\t-1744411251736480691\t2020-05-20 12:49:37.189\n52354-03-15 03:59:18.0\t34\t31\t160779139\tNormal\t39.77\t-94.15\t-1744411251736480691\t2020-05-20 12:49:37.158\n52354-03-15 03:54:58.0\t58\t13\t160779139\tNormal\t37.66\t-94.3\t-1744411251736480691\t2020-05-20 12:49:36.897999\n52354-03-15 03:53:48.0\t51\t24\t371182829\tNormal\t40.76\t-88.77\t-1744411251736480691\t2020-05-20 12:49:36.828\n52354-03-15 03:50:58.0\t83\t10\t1962261785\tNormal\t41.71\t-91.94\t-1744411251736480691\t2020-05-20 12:49:36.657999\n52354-03-15 03:50:18.0\t76\t15\t1090292248\tNormal\t42.23\t-91.78\t-1744411251736480691\t2020-05-20 12:49:36.617999\n52354-03-15 03:48:29.0\t63\t14\t927636994\tNormal\t40.76\t-88.77\t-1744411251736480691\t2020-05-20 12:49:36.509\n52354-03-15 03:45:08.0\t105\t25\t987179512\tNormal\t38.93\t-91.56\t-1744411251736480691\t2020-05-20 12:49:36.308\n52354-03-15 03:43:08.0\t37\t26\t1390372503\tNormal\t37.94\t-91.99\t-1744411251736480691\t2020-05-20 12:49:36.188\n52354-03-15 03:39:58.0\t102\t21\t1090292248\tNormal\t34.83\t-91.38\t-1744411251736480691\t2020-05-20 12:49:35.998\n52354-03-15 03:37:18.0\t49\t32\t1198242881\tNormal\t38.98\t-93.2\t-1744411251736480691\t2020-05-20 12:49:35.838\n52354-03-15 03:36:18.0\t85\t22\t1198242881\tNormal\t36.17\t-95.99\t-1744411251736480691\t2020-05-20 12:49:35.777999\n52354-03-15 03:31:38.0\t20\t17\t160405074\tNormal\t38.83\t-91.1\t-1744411251736480691\t2020-05-20 12:49:35.497999\n52354-03-15 03:27:38.0\t84\t23\t1927624662\tNormal\t34.96\t-91.14\t-1744411251736480691\t2020-05-20 12:49:35.257999\n52354-03-15 03:26:18.0\t96\t29\t1565885487\tNormal\t41.89\t-87.66\t-1744411251736480691\t2020-05-20 12:49:35.177999\n52354-03-15 03:24:48.0\t39\t30\t160405074\tNormal\t42.04\t-88.02\t-1744411251736480691\t2020-05-20 12:49:35.088\n52354-03-15 03:22:18.0\t52\t12\t1325712174\tNormal\t41.69\t-93.36\t-1744411251736480691\t2020-05-20 12:49:34.937999\n52354-03-15 03:21:38.0\t93\t27\t1594289134\tNormal\t41.89\t-87.66\t-1744411251736480691\t2020-05-20 12:49:34.897999\n52354-03-15 03:19:18.0\t69\t20\t1384345811\tNormal\t34.96\t-91.14\t-1744411251736480691\t2020-05-20 12:49:34.758\n52354-03-15 03:10:09.0\t61\t11\t1567254452\tNormal\t41.72\t-91.05\t-1744411251736480691\t2020-05-20 12:49:34.209\n52354-03-15 03:07:28.0\t100\t18\t1594289134\tNormal\t39.72\t-90.24\t-1744411251736480691\t2020-05-20 12:49:34.048\n52354-03-15 03:05:38.0\t31\t28\t803014426\tNormal\t34.89\t-91.74\t-1744411251736480691\t2020-05-20 12:49:33.937999\n52354-03-15 03:04:38.0\t16\t16\t1325562373\tNormal\t39.01\t-93.85\t-1744411251736480691\t2020-05-20 12:49:33.878\n52354-03-15 02:59:18.0\t76\t15\t1090292248\tNormal\t41.72\t-91.63\t-1744411251736480691\t2020-05-20 12:49:33.558\n52354-03-15 02:58:58.0\t34\t31\t160779139\tNormal\t39.76\t-93.93\t-1744411251736480691\t2020-05-20 12:49:33.537999\n52354-03-15 02:58:48.0\t51\t24\t371182829\tNormal\t41.11\t-88.42\t-1744411251736480691\t2020-05-20 12:49:33.528\n52354-03-15 02:55:23.0\t44\t19\t137128276\tNormal\t39.76\t-92.74\t-1744411251736480691\t2020-05-20 12:49:33.323\n52354-03-15 02:55:20.0\t63\t14\t927636994\tNormal\t40.38\t-89.17\t-1744411251736480691\t2020-05-20 12:49:33.32\n52354-03-15 02:55:18.0\t83\t10\t1962261785\tNormal\t41.7\t-91.59\t-1744411251736480691\t2020-05-20 12:49:33.318\n52354-03-15 02:52:58.0\t58\t13\t160779139\tNormal\t37.31\t-94.31\t-1744411251736480691\t2020-05-20 12:49:33.177999\n52354-03-15 02:49:38.0\t102\t21\t1090292248\tNormal\t34.96\t-91.14\t-1744411251736480691\t2020-05-20 12:49:32.977999\n52354-03-15 02:46:48.0\t105\t25\t987179512\tNormal\t38.94\t-91.74\t-1744411251736480691\t2020-05-20 12:49:32.808\n52354-03-15 02:41:39.0\t37\t26\t1390372503\tNormal\t37.99\t-91.69\t-1744411251736480691\t2020-05-20 12:49:32.499\n52354-03-15 02:40:58.0\t49\t32\t1198242881\tNormal\t38.97\t-93.01\t-1744411251736480691\t2020-05-20 12:49:32.457999\n52354-03-15 02:40:38.0\t85\t22\t1198242881\tNormal\t36.19\t-96.21\t-1744411251736480691\t2020-05-20 12:49:32.438\n52354-03-15 02:31:48.0\t39\t30\t160405074\tNormal\t41.89\t-87.66\t-1744411251736480691\t2020-05-20 12:49:31.908\n52354-03-15 02:28:48.0\t20\t17\t160405074\tNormal\t38.83\t-91.19\t-1744411251736480691\t2020-05-20 12:49:31.728\n52354-03-15 02:24:48.0\t96\t29\t1565885487\tNormal\t41.89\t-87.66\t-1744411251736480691\t2020-05-20 12:49:31.488\n52354-03-15 02:23:38.0\t84\t23\t1927624662\tNormal\t34.83\t-91.38\t-1744411251736480691\t2020-05-20 12:49:31.417999\n52354-03-15 02:22:08.0\t93\t27\t1594289134\tNormal\t42.04\t-88.02\t-1744411251736480691\t2020-05-20 12:49:31.328\n52354-03-15 02:19:28.0\t52\t12\t1325712174\tNormal\t41.62\t-93.58\t-1744411251736480691\t2020-05-20 12:49:31.168\n52354-03-15 02:18:58.0\t69\t20\t1384345811\tNormal\t34.83\t-91.38\t-1744411251736480691\t2020-05-20 12:49:31.137999\n52354-03-15 02:15:08.0\t31\t28\t803014426\tNormal\t34.83\t-91.38\t-1744411251736480691\t2020-05-20 12:49:30.908\n52354-03-15 02:13:18.0\t16\t16\t1325562373\tNormal\t39.0\t-93.65\t-1744411251736480691\t2020-05-20 12:49:30.798\n52354-03-15 02:12:39.0\t100\t18\t1594289134\tNormal\t39.72\t-90.24\t-1744411251736480691\t2020-05-20 12:49:30.759\n52354-03-15 02:08:18.0\t51\t24\t371182829\tNormal\t41.48\t-88.07\t-1744411251736480691\t2020-05-20 12:49:30.497999\n52354-03-15 02:04:38.0\t61\t11\t1567254452\tNormal\t41.71\t-91.32\t-1744411251736480691\t2020-05-20 12:49:30.278\n52354-03-15 02:01:58.0\t63\t14\t927636994\tNormal\t39.84\t-89.63\t-1744411251736480691\t2020-05-20 12:49:30.118\n52354-03-15 02:01:48.0\t34\t31\t160779139\tNormal\t39.77\t-93.6\t-1744411251736480691\t2020-05-20 12:49:30.108\n52354-03-15 01:54:08.0\t83\t10\t1962261785\tNormal\t41.67\t-91.24\t-1744411251736480691\t2020-05-20 12:49:29.648\n52354-03-15 01:53:18.0\t76\t15\t1090292248\tNormal\t41.74\t-91.47\t-1744411251736480691\t2020-05-20 12:49:29.598\n52354-03-15 01:52:48.0\t44\t19\t137128276\tNormal\t39.77\t-92.94\t-1744411251736480691\t2020-05-20 12:49:29.568\n52354-03-15 01:50:38.0\t58\t13\t160779139\tNormal\t37.16\t-94.46\t-1744411251736480691\t2020-05-20 12:49:29.438\n52354-03-15 01:46:48.0\t102\t21\t1090292248\tNormal\t35.03\t-90.94\t-1744411251736480691\t2020-05-20 12:49:29.208\n52354-03-15 01:45:38.0\t105\t25\t987179512\tNormal\t38.97\t-92.03\t-1744411251736480691\t2020-05-20 12:49:29.137999\n52354-03-15 01:43:58.0\t49\t32\t1198242881\tNormal\t38.93\t-92.85\t-1744411251736480691\t2020-05-20 12:49:29.038\n52354-03-15 01:43:39.0\t37\t26\t1390372503\tNormal\t38.04\t-91.55\t-1744411251736480691\t2020-05-20 12:49:29.019\n52354-03-15 01:40:38.0\t85\t22\t1198242881\tNormal\t36.23\t-96.44\t-1744411251736480691\t2020-05-20 12:49:28.838\n52354-03-15 01:32:48.0\t39\t30\t160405074\tNormal\t41.89\t-87.66\t-1744411251736480691\t2020-05-20 12:49:28.368\n52354-03-15 01:29:58.0\t93\t27\t1594289134\tNormal\t42.11\t-88.41\t-1744411251736480691\t2020-05-20 12:49:28.198\n52354-03-15 01:28:38.0\t20\t17\t160405074\tNormal\t38.87\t-91.33\t-1744411251736480691\t2020-05-20 12:49:28.118\n52354-03-15 01:24:28.0\t96\t29\t1565885487\tNormal\t42.04\t-88.02\t-1744411251736480691\t2020-05-20 12:49:27.868\n52354-03-15 01:23:59.0\t69\t20\t1384345811\tNormal\t34.89\t-91.74\t-1744411251736480691\t2020-05-20 12:49:27.839\n52354-03-15 01:18:48.0\t52\t12\t1325712174\tNormal\t41.62\t-93.58\t-1744411251736480691\t2020-05-20 12:49:27.528\n52354-03-15 01:17:58.0\t84\t23\t1927624662\tNormal\t34.89\t-91.74\t-1744411251736480691\t2020-05-20 12:49:27.478\n52354-03-15 01:14:48.0\t16\t16\t1325562373\tNormal\t38.99\t-93.45\t-1744411251736480691\t2020-05-20 12:49:27.288\n52354-03-15 01:13:58.0\t31\t28\t803014426\tNormal\t34.96\t-91.14\t-1744411251736480691\t2020-05-20 12:49:27.238\n52354-03-15 01:13:38.0\t100\t18\t1594289134\tNormal\t39.76\t-90.14\t-1744411251736480691\t2020-05-20 12:49:27.217999\n52354-03-15 01:09:48.0\t61\t11\t1567254452\tNormal\t41.74\t-91.47\t-1744411251736480691\t2020-05-20 12:49:26.988\n52354-03-15 01:07:18.0\t34\t31\t160779139\tNormal\t39.77\t-93.33\t-1744411251736480691\t2020-05-20 12:49:26.838\n52354-03-15 01:05:49.0\t63\t14\t927636994\tNormal\t39.1\t-89.74\t-1744411251736480691\t2020-05-20 12:49:26.749\n52354-03-15 01:05:28.0\t51\t24\t371182829\tNormal\t41.87\t-87.67\t-1744411251736480691\t2020-05-20 12:49:26.728\n52354-03-15 01:02:08.0\t83\t10\t1962261785\tNormal\t41.66\t-90.82\t-1744411251736480691\t2020-05-20 12:49:26.528\n52354-03-15 00:58:38.0\t44\t19\t137128276\tNormal\t39.78\t-93.13\t-1744411251736480691\t2020-05-20 12:49:26.318\n52354-03-15 00:54:58.0\t76\t15\t1090292248\tNormal\t41.71\t-91.32\t-1744411251736480691\t2020-05-20 12:49:26.097999\n52354-03-15 00:52:18.0\t105\t25\t987179512\tNormal\t38.96\t-92.22\t-1744411251736480691\t2020-05-20 12:49:25.937999\n52354-03-15 00:47:40.0\t102\t21\t1090292248\tNormal\t35.12\t-90.68\t-1744411251736480691\t2020-05-20 12:49:25.66\n52354-03-15 00:46:58.0\t85\t22\t1198242881\tNormal\t36.2\t-96.68\t-1744411251736480691\t2020-05-20 12:49:25.617999\n52354-03-15 00:45:58.0\t49\t32\t1198242881\tNormal\t38.95\t-92.63\t-1744411251736480691\t2020-05-20 12:49:25.558\n52354-03-15 00:44:58.0\t58\t13\t160779139\tNormal\t37.03\t-94.58\t-1744411251736480691\t2020-05-20 12:49:25.497999\n52354-03-15 00:42:18.0\t37\t26\t1390372503\tNormal\t38.09\t-91.44\t-1744411251736480691\t2020-05-20 12:49:25.337999\n52354-03-15 00:38:59.0\t39\t30\t160405074\tNormal\t42.04\t-88.02\t-1744411251736480691\t2020-05-20 12:49:25.139\n52354-03-15 00:34:28.0\t93\t27\t1594289134\tNormal\t42.21\t-88.64\t-1744411251736480691\t2020-05-20 12:49:24.868\n52354-03-15 00:32:48.0\t96\t29\t1565885487\tNormal\t42.11\t-88.41\t-1744411251736480691\t2020-05-20 12:49:24.768\n52354-03-15 00:31:48.0\t69\t20\t1384345811\tNormal\t34.81\t-91.93\t-1744411251736480691\t2020-05-20 12:49:24.708\n52354-03-15 00:30:59.0\t20\t17\t160405074\tNormal\t38.93\t-91.56\t-1744411251736480691\t2020-05-20 12:49:24.659\n52354-03-15 00:25:40.0\t84\t23\t1927624662\tNormal\t34.81\t-91.93\t-1744411251736480691\t2020-05-20 12:49:24.34\n52354-03-15 00:20:18.0\t31\t28\t803014426\tNormal\t35.03\t-90.94\t-1744411251736480691\t2020-05-20 12:49:24.017999\n52354-03-15 00:16:28.0\t34\t31\t160779139\tNormal\t39.78\t-93.13\t-1744411251736480691\t2020-05-20 12:49:23.788\n52354-03-15 00:16:19.0\t100\t18\t1594289134\tNormal\t39.74\t-89.96\t-1744411251736480691\t2020-05-20 12:49:23.779\n52354-03-15 00:14:08.0\t61\t11\t1567254452\tNormal\t41.72\t-91.63\t-1744411251736480691\t2020-05-20 12:49:23.648\n52354-03-15 00:12:38.0\t52\t12\t1325712174\tNormal\t41.69\t-93.36\t-1744411251736480691\t2020-05-20 12:49:23.558\n52354-03-15 00:10:48.0\t83\t10\t1962261785\tNormal\t41.56\t-90.64\t-1744411251736480691\t2020-05-20 12:49:23.448\n52354-03-15 00:10:18.0\t16\t16\t1325562373\tNormal\t38.98\t-93.2\t-1744411251736480691\t2020-05-20 12:49:23.417999\n52354-03-15 00:08:39.0\t51\t24\t371182829\tNormal\t41.87\t-87.67\t-1744411251736480691\t2020-05-20 12:49:23.319\n52354-03-15 00:02:09.0\t63\t14\t927636994\tNormal\t38.65\t-90.2\t-1744411251736480691\t2020-05-20 12:49:22.929\n52354-03-15 00:00:49.0\t76\t15\t1090292248\tNormal\t41.72\t-91.05\t-1744411251736480691\t2020-05-20 12:49:22.849\n52354-03-14 23:58:01.0\t44\t19\t137128276\tNormal\t39.77\t-93.33\t-1744411251736480691\t2020-05-20 12:49:22.681\n52354-03-14 23:57:58.0\t105\t25\t987179512\tNormal\t38.98\t-92.38\t-1744411251736480691\t2020-05-20 12:49:22.678\n52354-03-14 23:53:38.0\t102\t21\t1090292248\tNormal\t35.21\t-90.37\t-1744411251736480691\t2020-05-20 12:49:22.417999\n52354-03-14 23:50:48.0\t37\t26\t1390372503\tNormal\t38.14\t-91.3\t-1744411251736480691\t2020-05-20 12:49:22.248\n52354-03-14 23:50:28.0\t85\t22\t1198242881\tUnsafe following distance\t36.24\t-96.97\t-1744411251736480691\t2020-05-20 12:49:22.228\n52354-03-14 23:44:08.0\t58\t13\t160779139\tNormal\t37.03\t-94.58\t-1744411251736480691\t2020-05-20 12:49:21.848\n52354-03-14 23:40:08.0\t93\t27\t1594289134\tNormal\t42.25\t-88.96\t-1744411251736480691\t2020-05-20 12:49:21.608\n52354-03-14 23:39:29.0\t49\t32\t1198242881\tNormal\t38.98\t-92.53\t-1744411251736480691\t2020-05-20 12:49:21.569\n52354-03-14 23:36:38.0\t96\t29\t1565885487\tNormal\t42.21\t-88.64\t-1744411251736480691\t2020-05-20 12:49:21.398\n52354-03-14 23:36:29.0\t69\t20\t1384345811\tNormal\t34.8\t-92.09\t-1744411251736480691\t2020-05-20 12:49:21.389\n52354-03-14 23:33:39.0\t39\t30\t160405074\tNormal\t42.11\t-88.41\t-1744411251736480691\t2020-05-20 12:49:21.219\n52354-03-14 23:30:08.0\t20\t17\t160405074\tNormal\t38.94\t-91.74\t-1744411251736480691\t2020-05-20 12:49:21.008\n52354-03-14 23:23:38.0\t34\t31\t160779139\tNormal\t39.77\t-92.94\t-1744411251736480691\t2020-05-20 12:49:20.617999\n52354-03-14 23:19:28.0\t100\t18\t1594289134\tNormal\t39.77\t-89.78\t-1744411251736480691\t2020-05-20 12:49:20.368\n52354-03-14 23:19:08.0\t84\t23\t1927624662\tNormal\t34.8\t-92.09\t-1744411251736480691\t2020-05-20 12:49:20.348\n52354-03-14 23:14:18.0\t31\t28\t803014426\tNormal\t35.12\t-90.68\t-1744411251736480691\t2020-05-20 12:49:20.057999\n52354-03-14 23:13:59.0\t61\t11\t1567254452\tNormal\t42.23\t-91.78\t-1744411251736480691\t2020-05-20 12:49:20.039\n52354-03-14 23:13:39.0\t83\t10\t1962261785\tNormal\t41.59\t-90.2\t-1744411251736480691\t2020-05-20 12:49:20.019\n52354-03-14 23:12:19.0\t16\t16\t1325562373\tNormal\t38.97\t-93.01\t-1744411251736480691\t2020-05-20 12:49:19.939\n52354-03-14 23:10:08.0\t52\t12\t1325712174\tNormal\t41.71\t-93.04\t-1744411251736480691\t2020-05-20 12:49:19.808\n52354-03-14 23:08:08.0\t51\t24\t371182829\tNormal\t41.48\t-88.07\t-1744411251736480691\t2020-05-20 12:49:19.688\n52354-03-14 23:02:58.0\t102\t21\t1090292248\tNormal\t35.19\t-90.04\t-1744411251736480691\t2020-05-20 12:49:19.377999\n52354-03-14 23:02:19.0\t105\t25\t987179512\tNormal\t38.98\t-92.53\t-1744411251736480691\t2020-05-20 12:49:19.339\n52354-03-14 23:00:08.0\t63\t14\t927636994\tNormal\t38.65\t-90.2\t-1744411251736480691\t2020-05-20 12:49:19.208\n52354-03-14 22:58:38.0\t76\t15\t1090292248\tNormal\t41.62\t-90.7\t-1744411251736480691\t2020-05-20 12:49:19.118\n52354-03-14 22:57:18.0\t44\t19\t137128276\tNormal\t39.77\t-93.6\t-1744411251736480691\t2020-05-20 12:49:19.038\n52354-03-14 22:52:39.0\t85\t22\t1198242881\tNormal\t36.41\t-97.14\t-1744411251736480691\t2020-05-20 12:49:18.759\n52354-03-14 22:51:48.0\t37\t26\t1390372503\tNormal\t38.22\t-91.18\t-1744411251736480691\t2020-05-20 12:49:18.708\n52354-03-14 22:47:18.0\t58\t13\t160779139\tNormal\t37.16\t-94.46\t-1744411251736480691\t2020-05-20 12:49:18.438\n52354-03-14 22:42:41.0\t39\t30\t160405074\tNormal\t42.21\t-88.64\t-1744411251736480691\t2020-05-20 12:49:18.161\n52354-03-14 22:42:38.0\t49\t32\t1198242881\tNormal\t38.98\t-92.38\t-1744411251736480691\t2020-05-20 12:49:18.158\n52354-03-14 22:41:18.0\t69\t20\t1384345811\tNormal\t34.78\t-92.31\t-1744411251736480691\t2020-05-20 12:49:18.078\n52354-03-14 22:38:48.0\t96\t29\t1565885487\tNormal\t42.25\t-88.96\t-1744411251736480691\t2020-05-20 12:49:17.928\n52354-03-14 22:37:32.0\t93\t27\t1594289134\tNormal\t41.92\t-89.03\t-1744411251736480691\t2020-05-20 12:49:17.852\n52354-03-14 22:32:08.0\t34\t31\t160779139\tNormal\t39.76\t-92.74\t-1744411251736480691\t2020-05-20 12:49:17.528\n52354-03-14 22:29:08.0\t20\t17\t160405074\tNormal\t38.97\t-92.03\t-1744411251736480691\t2020-05-20 12:49:17.348\n52354-03-14 22:22:48.0\t83\t10\t1962261785\tNormal\t41.77\t-89.88\t-1744411251736480691\t2020-05-20 12:49:16.968\n52354-03-14 22:16:38.0\t84\t23\t1927624662\tNormal\t34.78\t-92.31\t-1744411251736480691\t2020-05-20 12:49:16.598\n52354-03-14 22:13:38.0\t100\t18\t1594289134\tNormal\t38.65\t-90.2\t-1744411251736480691\t2020-05-20 12:49:16.417999\n52354-03-14 22:13:08.0\t16\t16\t1325562373\tNormal\t38.93\t-92.85\t-1744411251736480691\t2020-05-20 12:49:16.388\n52354-03-14 22:12:38.0\t51\t24\t371182829\tNormal\t41.11\t-88.42\t-1744411251736480691\t2020-05-20 12:49:16.358\n52354-03-14 22:12:18.0\t61\t11\t1567254452\tNormal\t42.23\t-91.78\t-1744411251736480691\t2020-05-20 12:49:16.337999\n"},{"type":"TEXT","data":""}]}},{"title":"Stop 1st query","text":"query1.stop","user":"admin","dateUpdated":"2020-05-20T12:50:03+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1589969898948_1807706265","id":"20180321-191351_334605691","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5985","dateFinished":"2020-05-20T12:50:03+0200","dateStarted":"2020-05-20T12:50:03+0200"},{"title":"Filter out normal events","text":"val jsonFilteredDf = jsonDf.where(\"data.eventType !='Normal'\")\n","user":"admin","dateUpdated":"2020-05-20T12:27:20+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"jsonFilteredDf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [timestamp: timestamp, truckId: bigint ... 7 more fields]\n"}]},"apps":[],"jobName":"paragraph_1589969898948_861858412","id":"20180321-003449_1651561548","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5986","dateFinished":"2020-05-20T12:27:20+0200","dateStarted":"2020-05-20T12:27:20+0200"},{"title":"Run 2nd query on filtered data into in memory \"table\"","text":"import org.apache.spark.sql.streaming.{OutputMode, Trigger}\nimport scala.concurrent.duration._\nval query1 = jsonFilteredDf.writeStream\n                            .format(\"memory\")\n                            .queryName(\"filtered_truck_position\")\n                            .start()","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.streaming.{OutputMode, Trigger}\nimport scala.concurrent.duration._\nquery1: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@3898ac04\n"}]},"apps":[],"jobName":"paragraph_1589969898949_1891441265","id":"20200520-120000_1354922488","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5987"},{"text":"spark.sql (\"select * from filtered_truck_position\").show()  ","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-------+--------+-------+---------+--------+---------+-------------+---------+\n|timestamp|truckId|driverId|routeId|eventType|latitude|longitude|correlationId|eventTime|\n+---------+-------+--------+-------+---------+--------+---------+-------------+---------+\n+---------+-------+--------+-------+---------+--------+---------+-------------+---------+\n\n"}]},"apps":[],"jobName":"paragraph_1589969898950_1333527527","id":"20200520-120052_136194769","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5988"},{"title":"Stop 2nd query","text":"query2.stop","user":"admin","dateUpdated":"2020-05-20T12:27:11+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1589969898950_-1118892032","id":"20200520-120115_1920176114","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5989"},{"title":"Run 3rd query - Write non-normal events to Kafka topic","text":"val query3 = jsonFilteredDf\n                  .selectExpr(\"to_json(struct(*)) AS value\")\n                  .writeStream\n                  .format(\"kafka\")\n                  .option(\"kafka.bootstrap.servers\", \"kafka-1:19092\")\n                  .option(\"topic\",\"dangerous_driving_spark\")\n                  .option(\"checkpointLocation\", \"/tmp\")\n                  .start()    ","user":"admin","dateUpdated":"2020-05-20T12:27:24+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query3: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@2e84871c\n"}]},"apps":[],"jobName":"paragraph_1589969898951_311352930","id":"20180321-014546_1351857761","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5990","dateFinished":"2020-05-20T12:27:24+0200","dateStarted":"2020-05-20T12:27:24+0200"},{"text":"query3.stop","user":"admin","dateUpdated":"2020-05-20T12:31:42+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1589969898951_1401206535","id":"20180321-175448_1799122085","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5991","dateFinished":"2020-05-20T12:31:42+0200","dateStarted":"2020-05-20T12:31:42+0200"},{"title":"Retrieve static driver information","text":"val opts = Map(\n  \"url\" -> \"jdbc:postgresql://postgresql/sample?user=sample&password=sample\",\n  \"driver\" -> \"org.postgresql.Driver\",\n  \"dbtable\" -> \"driver\")\nval driverRawDf = spark.read.format(\"jdbc\").options(opts).load()  \nval driverDf = driverRawDf.selectExpr(\"id as driverId\", \"first_name as firstName\", \"last_name as lastName\")\n","user":"admin","dateUpdated":"2020-05-20T12:31:21+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"opts: scala.collection.immutable.Map[String,String] = Map(url -> jdbc:postgresql://postgresql/sample?user=sample&password=sample, driver -> org.postgresql.Driver, dbtable -> driver)\ndriverRawDf: org.apache.spark.sql.DataFrame = [id: bigint, first_name: string ... 4 more fields]\ndriverDf: org.apache.spark.sql.DataFrame = [driverId: bigint, firstName: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1589969898952_1664589159","id":"20180321-175625_429852000","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5992","dateFinished":"2020-05-20T12:31:22+0200","dateStarted":"2020-05-20T12:31:21+0200"},{"title":"Left-Outer-Join TruckPosition to Driver DataFrame","text":"val jsonTruckPlusDriverDf = jsonFilteredDf.join(driverDf, Seq(\"driverId\"), \"left\")   \n","user":"admin","dateUpdated":"2020-05-20T12:31:27+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898952_633721469","id":"20180321-175532_920449172","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5993","dateFinished":"2020-05-20T12:31:27+0200","dateStarted":"2020-05-20T12:31:27+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"jsonTruckPlusDriverDf: org.apache.spark.sql.DataFrame = [driverId: bigint, timestamp: timestamp ... 9 more fields]\n"}]}},{"title":"Run 4th query - Write Joined information to Kafka topic \"dangerous_driving_spark\"","text":"val query4 = jsonTruckPlusDriverDf\n                  .selectExpr(\"to_json(struct(*)) AS value\")\n                  .writeStream\n                  .format(\"kafka\")\n                  .option(\"kafka.bootstrap.servers\", \"kafka-1:19092\")\n                  .option(\"topic\",\"dangerous_driving_spark\")\n                  .option(\"checkpointLocation\", \"/tmp/dangerous_driving\")\n                  .start()   ","user":"admin","dateUpdated":"2020-05-20T12:32:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query4: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@47fe9900\n"}]},"apps":[],"jobName":"paragraph_1589969898952_-1281555544","id":"20180321-175741_2030864","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5994","dateFinished":"2020-05-20T12:31:55+0200","dateStarted":"2020-05-20T12:31:45+0200"},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589970715026_1728241912","id":"20200520-123155_1723644245","dateCreated":"2020-05-20T12:31:55+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9358","text":"query4.stop","dateUpdated":"2020-05-20T12:34:56+0200","dateFinished":"2020-05-20T12:34:57+0200","dateStarted":"2020-05-20T12:34:56+0200","results":{"code":"SUCCESS","msg":[]}},{"text":"val countByEventTypeWindowedDf = jsonDf //jsonFilteredDf\n            .withWatermark(\"eventTime\",\"10 minutes\")\n            .groupBy(\n                 window($\"eventTime\", \"30 seconds\",\"30 seconds\"),\n                $\"eventType\")\n            .count()","user":"admin","dateUpdated":"2020-05-20T12:39:51+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898953_-513887292","id":"20180318-180506_31860190","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5995","dateFinished":"2020-05-20T12:39:52+0200","dateStarted":"2020-05-20T12:39:51+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"countByEventTypeWindowedDf: org.apache.spark.sql.DataFrame = [window: struct<start: timestamp, end: timestamp>, eventType: string ... 1 more field]\n"}]}},{"title":"Run 5h query -  with output to in-memory table \"count_by_event_type\"","text":"import org.apache.spark.sql.streaming.{OutputMode, Trigger}\nimport scala.concurrent.duration._\nval query5 = countByEventTypeWindowedDf.writeStream\n                            .format(\"memory\")\n                            .queryName(\"count_by_event_type\")\n                            .start()\n","user":"admin","dateUpdated":"2020-05-20T12:48:36+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898953_-1672708510","id":"20180318-180647_279856728","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5996","dateFinished":"2020-05-20T12:36:57+0200","dateStarted":"2020-05-20T12:36:47+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.streaming.{OutputMode, Trigger}\nimport scala.concurrent.duration._\nquery5: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@192afaf3\n"}]}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"window":"string","eventType":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589970793834_-1526577142","id":"20200520-123313_401007988","dateCreated":"2020-05-20T12:33:13+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9473","text":"%sql\nselect * from count_by_event_type","dateUpdated":"2020-05-20T12:37:39+0200","dateFinished":"2020-05-20T12:37:39+0200","dateStarted":"2020-05-20T12:37:39+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"window\teventType\tcount\n"},{"type":"TEXT","data":""}]}},{"text":"query5.stop\n","user":"admin","dateUpdated":"2020-05-20T12:37:41+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589970881532_2028701120","id":"20200520-123441_1568432622","dateCreated":"2020-05-20T12:34:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12880","dateFinished":"2020-05-20T12:37:42+0200","dateStarted":"2020-05-20T12:37:41+0200","results":{"code":"SUCCESS","msg":[]}},{"title":"Run 6th query - Write Counts By Event Type to Kafka topic \"count_by_event_type_spark\"","text":"val query6 = countByEventTypeWindowedDf\n                  .selectExpr(\"to_json(struct(*)) AS value\")\n                  .writeStream\n                  .format(\"kafka\")\n                  .option(\"kafka.bootstrap.servers\", \"kafka-1:19092\")\n                  .option(\"topic\",\"count_by_event_type_spark\")\n                  .option(\"checkpointLocation\", \"/tmp/countByEventType\")\n                  .outputMode(\"update\")\n                  .start() ","user":"admin","dateUpdated":"2020-05-20T12:48:53+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898953_1478874927","id":"20180321-184257_1001462643","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5997","dateFinished":"2020-05-20T12:47:33+0200","dateStarted":"2020-05-20T12:47:33+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query6: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@64f82014\n"}]}},{"text":"query6.stop","user":"admin","dateUpdated":"2020-05-20T12:48:56+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898954_280907230","id":"20180321-184109_1496216192","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5999","dateFinished":"2020-05-20T12:48:56+0200","dateStarted":"2020-05-20T12:48:56+0200","results":{"code":"SUCCESS","msg":[]}},{"text":"query6.explain","user":"admin","dateUpdated":"2020-05-20T12:38:42+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898954_444112314","id":"20180318-180724_1533725921","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6000","dateFinished":"2020-05-20T12:38:43+0200","dateStarted":"2020-05-20T12:38:42+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\nWriteToDataSourceV2 org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@36f8ed5f\n+- HashAggregate(keys=[window#3487-T600000ms, eventType#51], functions=[count(1)])\n   +- StateStoreSave [window#3487-T600000ms, eventType#51], state info [ checkpoint = s3a://application-bucket/tmp/countByEventType/state, runId = 47dfabb3-225c-4bea-9d85-09f9c7e6326c, opId = 0, ver = 0, numPartitions = 200], Append, 0, 2\n      +- *(4) HashAggregate(keys=[window#3487-T600000ms, eventType#51], functions=[merge_count(1)])\n         +- StateStoreRestore [window#3487-T600000ms, eventType#51], state info [ checkpoint = s3a://application-bucket/tmp/countByEventType/state, runId = 47dfabb3-225c-4bea-9d85-09f9c7e6326c, opId = 0, ver = 0, numPartitions = 200], 2\n            +- *(3) HashAggregate(keys=[window#3487-T600000ms, eventType#51], functions=[merge_count(1)])\n               +- Exchange hashpartitioning(window#3487-T600000ms, eventType#51, 200)\n                  +- *(2) HashAggregate(keys=[window#3487-T600000ms, eventType#51], functions=[partial_count(1)])\n                     +- *(2) Project [named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) as double) = (cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) THEN (CEIL((cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) + 1) ELSE CEIL((cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) END + 0) - 1) * 30000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) as double) = (cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) THEN (CEIL((cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) + 1) ELSE CEIL((cast((precisetimestampconversion(eventTime#46-T600000ms, TimestampType, LongType) - 0) as double) / 3.0E7)) END + 0) - 1) * 30000000) + 30000000), LongType, TimestampType)) AS window#3487-T600000ms, eventType#51]\n                        +- *(2) Filter isnotnull(eventTime#46-T600000ms)\n                           +- EventTimeWatermark eventTime#46: timestamp, interval 10 minutes\n                              +- Project [jsontostructs(StructField(timestamp,TimestampType,true), StructField(truckId,LongType,true), StructField(driverId,LongType,true), StructField(routeId,LongType,true), StructField(eventType,StringType,true), StructField(latitude,DoubleType,true), StructField(longitude,DoubleType,true), StructField(correlationId,StringType,true), cast(value#3665 as string), Some(Europe/Berlin)).eventType AS eventType#51, cast((cast(jsontostructs(StructField(timestamp,TimestampType,true), StructField(truckId,LongType,true), StructField(driverId,LongType,true), StructField(routeId,LongType,true), StructField(eventType,StringType,true), StructField(latitude,DoubleType,true), StructField(longitude,DoubleType,true), StructField(correlationId,StringType,true), cast(value#3665 as string), Some(Europe/Berlin)).timestamp as double) / 1000.0) as timestamp) AS eventTime#46]\n                                 +- *(1) Project [key#3664, value#3665, topic#3666, partition#3667, offset#3668L, timestamp#3669, timestampType#3670]\n                                    +- *(1) ScanV2 kafka[key#3664, value#3665, topic#3666, partition#3667, offset#3668L, timestamp#3669, timestampType#3670] (Options: [subscribe=truck_position,kafka.bootstrap.servers=kafka-1:19092,kafka-2:19093])\n"}]}},{"text":"query6.lastProgress","user":"admin","dateUpdated":"2020-05-20T12:38:54+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898955_1510158402","id":"20180318-180757_1099213028","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6001","dateFinished":"2020-05-20T12:38:54+0200","dateStarted":"2020-05-20T12:38:54+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res14: org.apache.spark.sql.streaming.StreamingQueryProgress = null\n"}]}},{"text":"query6.status","user":"admin","dateUpdated":"2020-05-20T12:38:59+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898955_-1581058304","id":"20180321-005232_1831339624","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6002","dateFinished":"2020-05-20T12:39:00+0200","dateStarted":"2020-05-20T12:38:59+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res15: org.apache.spark.sql.streaming.StreamingQueryStatus =\n{\n  \"message\" : \"Processing new data\",\n  \"isDataAvailable\" : true,\n  \"isTriggerActive\" : true\n}\n"}]}},{"text":"spark.streams.active","user":"admin","dateUpdated":"2020-05-20T12:39:07+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898955_-949476981","id":"20180321-183944_2050158604","dateCreated":"2020-05-20T12:18:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6003","dateFinished":"2020-05-20T12:39:07+0200","dateStarted":"2020-05-20T12:39:07+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res16: Array[org.apache.spark.sql.streaming.StreamingQuery] = Array(org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@696d43cf)\n"}]}},{"text":"jsonDf.select(from_json($\"value\", schema)).show()\nschema","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898955_1272400958","id":"20180318-190346_408958636","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6004"},{"text":"jsonDf.printSchema","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898956_-1119338841","id":"20180318-190633_820758729","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6005"},{"text":"import org.apache.spark.sql.types.IntegerType\n\nval df = Seq(\"\"\"{\"a\": 1,\"b\":2}\"\"\").toDS()\n    val schema = new StructType().add(\"a\", IntegerType).add(\"b\", IntegerType)\n\ndf.select(from_json($\"value\", schema)).show()","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898956_-1371216717","id":"20180318-190950_885393720","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6006"},{"text":"val opts = Map(\n  \"url\" -> \"jdbc:postgresql://db/sample?user=sample&password=sample\",\n  \"dbtable\" -> \"driver\")\nval df = spark.\n  read.\n  format(\"jdbc\").\n  options(opts).\n  load","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898957_-1246654432","id":"20180318-191240_255163371","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6007"},{"text":"df.explain","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898957_-537376502","id":"20180318-214906_832706337","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6008"},{"text":"df.show(truncate=false)","user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898958_-957870568","id":"20180318-213135_505497103","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6009"},{"user":"admin","dateUpdated":"2020-05-20T12:18:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589969898958_1083806393","id":"20180318-213203_2111194532","dateCreated":"2020-05-20T12:18:18+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6010"}],"name":"Spark Structured Streaming","id":"2FBFQQV16","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}